# Quality System — Evaluation Platform

Model-driven evaluation builder with link-based participation and built-in statistics for academic/organizational quality assurance.

The system enables administrators to create and publish evaluation models (forms) and allows evaluators to access those models via shareable links. Responses are collected and aggregated into statistics dashboards to support data-driven decisions.

This document provides an overview, techniques used, setup, operational guidance, expected problems with mitigations, and the system’s advantages.

---

## Key Capabilities

- Model authoring and publishing
  - Create evaluation models with multiple question types.
  - Publish models and generate shareable evaluation links for target audiences.
- Link-based participation
  - Evaluators access forms via a link; no account required by default.
  - Form auto-renders question components based on type.
- Data collection and validation
  - Client-side validation and structured submission payloads.
- Statistics and reporting
  - Aggregate metrics and distributions for responses per form, type, and target.
- Bilingual-ready UI
  - Arabic-first experience (RTL), supporting bilingual text rendering.

---

## How It Works (End-to-End)

1. Authoring
   - Admin creates a form (evaluation model) and chooses:
     - FormType (evaluation kind) and FormTarget (audience/role).
     - Questions with types such as multiple choice, evaluation scale, true/false, and essay.
   - Each question is stored with an ID, Title, and TypeQuestion.

2. Publishing & Link Generation
   - When the form status is "published," the system generates a link:
     - Example (as generated by the system):  
       http://{host}/{base}/evaluation-form.php?evaluation={FormType}&Evaluator={FormTarget}
   - Links can be copied and distributed to the intended evaluators.

3. Evaluator Experience
   - The link opens the evaluation form page (evaluation-form.php).
   - The page loads the model data and renders question components dynamically based on TypeQuestion (e.g., multiple_choice, evaluation, true_false, essay).
   - Data attributes on DOM nodes (data-question-id, data-question-type) enable the front-end script to handle user input and validation.

4. Submission & Storage
   - Client-side JS collects answers and posts to the back-end endpoint (implementation depends on your backend controller).
   - The server validates the payload and persists the responses.

5. Statistics & Insights
   - The statistics page loads constants and datasets (FORM_TYPES, FORM_TARGETS) into window scope and visualizes results using scripts/statistics.js.
   - Typical outputs include counts, distributions, completion rates, and basic reliability checks (as applicable to your configuration).

---

## Techniques and Design Choices

- Backend
  - PHP 8+ with modern features (e.g., match expressions for component routing).
  - Modular page composition using PHP includes for reusable components.
  - Server-side rendering for initial page load; JSON hydration for dynamic parts.

- Frontend
  - Vanilla JS modules for form logic (scripts/evaluation-form.js) and statistics (scripts/statistics.js).
  - Bilingual text support via helper (e.g., formatBilingualText) to render Arabic/English where provided.
  - Data attributes (data-question-id, data-question-type) for targeted behavior without heavy frameworks.
  - CSS styling with local stylesheets and Font Awesome icons for UI elements.

- Information Flow
  - PHP injects configuration values into the browser (e.g., window.FORM_TYPES, window.FORM_TARGETS).
  - Question type resolution maps to component includes:
    - multiple_choice => components/answer_types/multiple-choice.php
    - evaluation => components/answer_types/evaluation.php
    - true_false => components/answer_types/boolean.php
    - essay => components/answer_types/essay.php

- Link Generation Pattern
  - Base: http://{HTTP_HOST}{dirname(PHP_SELF)}
  - Query params:
    - evaluation = FormType
    - Evaluator = FormTarget
  - The combination determines which model and audience settings apply at runtime.

- Statistics
  - Aggregation and visualization performed client-side via statistics.js using data exposed by PHP.
  - Extendable to server-side pre-aggregation or API-driven dashboards as needed.

---

## Repository Structure (Highlights)

- /evaluation-form.php — Renders the evaluation form, includes answer-type components, and loads scripts/evaluation-form.js.
- /forms.php — Admin listing for forms; generates copyable public evaluation links when a form is published.
- /statistics.php — Statistics dashboard; exposes FORM_TYPES and FORM_TARGETS to the client and loads scripts/statistics.js.
- /components
  - /answer_types
    - multiple-choice.php
    - evaluation.php
    - boolean.php
    - essay.php
  - footer.php
  - ComponentsStyles.css
- /scripts
  - evaluation-form.js
  - statistics.js
  - /lib/utils.js
- /styles
  - evaluation-form.css
- /assets
  - /icons (e.g., college.png, SVG logos)

Note: Some file names and locations may vary slightly depending on your deployment; align with your environment.

---

## Setup and Configuration

- Prerequisites
  - PHP 8+ (with mbstring and intl recommended for multilingual support).
  - Web server (Apache/Nginx) or PHP’s built-in server for local.
  - Database (e.g., MySQL/MariaDB) if your deployment stores models and responses server-side.

- Local Run (example)
  - Place the repository in your web root, or run:
    - php -S localhost:8080 -t .
  - Navigate to:
    - http://localhost:8080/forms.php (admin listing)
    - http://localhost:8080/statistics.php (statistics)
    - An evaluation link generated by forms.php

- Configuration Notes
  - Ensure assets (icons/styles/scripts) are reachable via relative paths from the PHP pages.
  - Confirm that FORM_TYPES and FORM_TARGETS are defined on the server-side before statistics.php renders.
  - If behind a proxy or HTTPS, adjust base URL generation (HTTP_HOST, PHP_SELF) and force HTTPS to avoid mixed content.

- Database (conceptual)
  - forms (id, title, FormType, FormTarget, schema_json, status, created_at, updated_at)
  - questions (id, form_id, TypeQuestion, TitleQuestion, order_index, properties_json)
  - responses (id, form_id, evaluator_group, submitted_at, meta_json)
  - answers (id, response_id, question_id, value, value_json)
  - These can be adapted to your needs; ensure referential integrity and add indexes for analytics queries.

---

## Question Types (Built-in)

- multiple_choice (single/multi select)
- evaluation (Likert/scale)
- true_false (boolean)
- essay (long text)

Extend by adding a new component file and mapping it in the type resolution logic.

---

## Statistics Provided (Baseline)

- Response counts per form, type, and target.
- Distributions for choice questions (option counts/percentages).
- Summary stats for scale questions (mean, median).
- Completion metrics (views vs. submissions if instrumented).
- Time-based trends (if timestamps are available on responses).

Recommendations:
- Pre-aggregate frequent queries to speed up dashboards.
- Keep metric definitions consistent and documented to avoid ambiguity.

---

## Security, Privacy, and Integrity

- Link Access
  - Generated links include evaluation (FormType) and Evaluator (FormTarget) parameters.
  - For public forms, expect link sharing; restrict by policy as needed.
- Recommended Hardening
  - Tokenize public links (add opaque tokens and verify server-side).
  - Add optional expiry or single-use constraints for sensitive evaluations.
  - Rate limiting and basic bot protection on submission endpoints.
  - Validate inputs server-side; sanitize outputs to prevent XSS.
- Data Protection
  - Store minimal PII; separate PII from response data where possible.
  - Use HTTPS in production; set secure cookies if used.

---

## Expected Problems and Mitigations

- Link Leakage or Unauthorized Participation
  - Problem: Links may circulate beyond intended audience.
  - Mitigations: Add signed tokens, expirations, revocation, or IP/whitelist checks. Consider optional login for private cohorts.

- Duplicate or Partial Submissions
  - Problem: Users refresh or re-open links; intermittent connectivity causes retries.
  - Mitigations: Idempotency (client token or server nonce); visible submission confirmation; server dedup on (form_id, unique_key).

- Model Misconfiguration
  - Problem: Invalid question weights, missing components, or unbalanced scales.
  - Mitigations: Authoring validation, preview mode, and required review before publish.

- Data Quality Issues
  - Problem: Skips, straight-lining, or contradictory answers.
  - Mitigations: Client-side required flags; attention checks; server-side data-quality indicators and QA views.

- Performance Under Load
  - Problem: High traffic on a popular form slows page loads.
  - Mitigations: Cache static assets; paginate/segment large forms; pre-aggregate stats; enable HTTP caching and CDN.

- Localization and Accessibility
  - Problem: RTL rendering, font issues, or inaccessible controls.
  - Mitigations: Test RTL thoroughly; ensure components have labels; follow WCAG 2.1 AA practices.

- Analytics Consistency
  - Problem: Conflicting numbers between pages/exports.
  - Mitigations: Single source of truth for metrics; clear definitions; versioned model and metric calculations.

---

## Advantages of This System

- Frictionless Participation
  - Evaluators join via a link; no account required for most use cases.

- Configurable and Extensible
  - Add new question types by creating new component files and mapping them in the rendering logic.

- Bilingual-Ready and RTL Support
  - Arabic-first UI with bilingual text rendering via helper utilities.

- Operational Simplicity
  - PHP-based SSR with light JS; easy to deploy on common hosting stacks.

- Actionable Insights
  - Built-in statistics provide quick feedback loops and highlight trends and data quality.

---

## Good Practices When Extending

- Keep question type rendering centralized in a single resolver to avoid divergence.
- Use data attributes for JS hooks; avoid brittle DOM queries by class alone.
- Document any new metric’s definition alongside its visualization.
- Add basic unit tests for JS utilities (scripts/lib/utils.js) and any PHP validation helpers.
- Avoid hardcoding absolute URLs; rely on server variables for base URL derivation and support reverse proxies.

---

## Future Enhancements (Suggested)

- Tokenized, expiring public links with revocation UI.
- Draft autosave and resume links for evaluators.
- Server-side pre-aggregation for heavy statistics.
- Role-based access control for form authors vs. reviewers.
- Export center (CSV/JSON/XLSX) with data dictionaries.
- Reliability metrics (e.g., inter-rater agreement) when applicable.

---

## Troubleshooting

- Styles or icons not loading
  - Check relative paths from the PHP file to /styles and /assets/icons.
- Statistics not rendering
  - Ensure FORM_TYPES and FORM_TARGETS are defined server-side before including statistics.js.
- Components not appearing for a question
  - Verify TypeQuestion matches an existing component mapping and that the include path is correct.

---

## License

Specify your license (e.g., MIT, proprietary). If none, access is limited to authorized users per your organization’s policy.

---

## Acknowledgements

- Font Awesome for icons.
- Developer: Mohamed Fouad Bala.
